<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Shattered Star</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    body {
      margin: 0;
      background: black;
      color: #00ccff;
      font-family: "Courier New", monospace;
      overflow: hidden;
    }

    .screen {
      display: none;
      position: absolute;
      inset: 0;
      padding: 40px;
    }

    .screen.active {
      display: block;
    }

    h1, h2, h3 {
      margin: 0 0 20px 0;
      text-align: center;
    }

    button {
      cursor: pointer;
      font-family: inherit;
    }

    /* TITLE SCREEN */
    #title-screen {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    #title-bg {
      position: absolute;
      inset: 0;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      z-index: -1;
    }

    #press-enter {
      margin-top: 40px;
      font-size: 1.4em;
      transition: 0.1s;
    }

    /* LOADING SCREEN */
    #loading-screen {
      display: flex;
      justify-content: center;
      align-items: center;
      text-align: center;
    }

    .loading-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
    }

    .loading-text {
      font-size: 1.4em;
      letter-spacing: 4px;
      opacity: 0.8;
    }

    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 6px solid #003344;
      border-top-color: #00ccff;
      border-radius: 50%;
      animation: spin 0.9s linear infinite;
    }

    @keyframes spin {
      from { transform: rotate(0deg); }
      to   { transform: rotate(360deg); }
    }

    /* START SCREEN */
    #start-screen {
      text-align: center;
      padding-top: 120px;
    }

    #new-game {
      padding: 20px 40px;
      font-size: 1.4em;
      background: #00ccff;
      color: black;
      border: none;
    }

    /* NEW GAME SCREEN */
    #newgame-screen {
      text-align: center;
      padding-top: 60px;
    }

    .hero-grid, .difficulty-grid {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 20px 0;
    }

    .hero-select, .difficulty-select {
      padding: 15px 25px;
      background: #111;
      border: 2px solid #444;
      color: #00ccff;
      font-size: 1.1em;
      transition: 0.2s;
    }

    .hero-select.selected,
    .difficulty-select.selected {
      border-color: #00ccff;
      background: #003344;
    }

    #begin-run {
      margin-top: 40px;
      padding: 20px 40px;
      font-size: 1.4em;
      background: #00ccff;
      color: black;
      border: none;
    }

    /* ACT I INTRO */
    #act1-intro {
      position: fixed;
      inset: 0;
      background: black;
      color: #00ccff;
      display: none;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 60px;
      z-index: 20;
    }

    #act1-intro.active {
      display: flex;
    }

    .intro-text h1 {
      margin-bottom: 20px;
    }

    .intro-text .continue {
      margin-top: 40px;
      opacity: 0.7;
      font-size: 1.1em;
    }

    /* MAP SCREEN */
    #map-screen {
      position: absolute;
      inset: 0;
      overflow: hidden;
    }

    #map-canvas {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
    }

    .node {
      position: absolute;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: #003344;
      border: 2px solid #00ccff;
      color: #00ccff;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      font-weight: bold;
    }

    /* COMBAT SCREEN */
    #combat-screen {
      text-align: center;
      padding-top: 120px;
      font-size: 1.6em;
    }
  </style>
</head>

<body>

  <!-- TITLE SCREEN -->
  <div id="title-screen" class="screen">
    <div id="title-bg"></div>
    <h1>SHATTERED STAR</h1>
    <div id="press-enter">PRESS ENTER</div>
  </div>

  <!-- LOADING SCREEN -->
  <div id="loading-screen" class="screen">
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <div class="loading-text">LOADING...</div>
    </div>
  </div>

  <!-- START SCREEN -->
  <div id="start-screen" class="screen">
    <h1>START</h1>
    <button id="new-game">NEW GAME</button>
  </div>

  <!-- NEW GAME SCREEN -->
  <div id="newgame-screen" class="screen">
    <h1>NEW GAME</h1>

    <div class="section">
      <h2>Select Hero</h2>
      <div class="hero-grid">
        <button class="hero-select" data-hero="korvax">Korvax Rend</button>
        <button class="hero-select" data-hero="lyria">Lyria Voss</button>
        <button class="hero-select" data-hero="auren">Auren Solari</button>
        <button class="hero-select" data-hero="shade">Shade</button>
      </div>
    </div>

    <div class="section">
      <h2>Select Difficulty</h2>
      <div class="difficulty-grid">
        <button class="difficulty-select selected" data-difficulty="normal">Normal</button>
        <button class="difficulty-select" data-difficulty="hard">Hard</button>
        <button class="difficulty-select" data-difficulty="voidborn">Voidborn</button>
      </div>
    </div>

    <button id="begin-run">Begin Run</button>
  </div>

  <!-- ACT I INTRO -->
  <div id="act1-intro"></div>

  <!-- MAP SCREEN -->
  <div id="map-screen" class="screen">
    <canvas id="map-canvas"></canvas>
  </div>

  <!-- COMBAT SCREEN -->
  <div id="combat-screen" class="screen"></div>

  <!-- CORE ENGINE -->
  <script type="module" src="js/core/state.js"></script>
  <script type="module" src="js/core/stateRouter.js"></script>
  <script type="module" src="js/core/renderer.js"></script>
  <script type="module" src="js/core/transitions.js"></script>
  <script type="module" src="js/core/crt.js"></script>

  <!-- UI -->
  <script type="module" src="js/ui/titleScreen.js"></script>
  <script type="module" src="js/ui/mainMenu.js"></script>
  <script type="module" src="js/ui/newGame.js"></script>
  <script type="module" src="js/ui/loadingScreen.js"></script>

  <!-- SYSTEMS -->
  <script type="module" src="js/systems/map/mapUI.js"></script>
  <script type="module" src="js/systems/map/mapCanvasScene.js"></script>
  <script type="module" src="js/systems/map/mapGenerator.js"></script>

  <script type="module" src="js/systems/combat/combatUI.js"></script>
  <script type="module" src="js/systems/combat/engine.js"></script>
  <script type="module" src="js/systems/combat/actions.js"></script>
  <script type="module" src="js/systems/combat/statusEffects.js"></script>
  <script type="module" src="js/systems/combat/enemyAI.js"></script>

  <!-- ENTRY POINT -->
  <script type="module">
    import { setState, STATE } from "./js/core/state.js";
    import { applyState } from "./js/core/stateRouter.js";

    setState(STATE.TITLE);
    applyState();
  </script>

</body>
</html>
