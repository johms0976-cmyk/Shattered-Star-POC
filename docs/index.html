<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Shattered-Star-POC</title>

  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: black;
      overflow: hidden;
      font-family: monospace;
    }

    .screen {
      position: absolute;
      width: 100vw;
      height: 100vh;
      top: 0;
      left: 0;
      display: none;
    }

    .active {
      display: block;
    }

    .title-frame {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .press-enter {
      position: absolute;
      bottom: 5%;
      width: 100%;
      text-align: center;
      font-size: 2em;
      color: #00ccff;
      animation: blink 1s step-end infinite;
    }

    @keyframes blink {
      50% { opacity: 0; }
    }

    .menu {
      position: absolute;
      top: 55%;
      width: 100%;
      text-align: center;
      font-size: 2em;
      color: #00ccff;
    }

    .menu-item {
      margin: 15px 0;
      cursor: pointer;
      transition: color 0.2s;
    }

    .menu-item:hover {
      color: #ffffff;
    }

    .glitch-flash {
      position: absolute;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: white;
      opacity: 0;
      pointer-events: none;
      mix-blend-mode: screen;
      z-index: 999;
      animation: none;
    }

    @keyframes glitchFlash {
      0%   { opacity: 0; transform: translate(0,0); filter: none; }
      10%  { opacity: 1; transform: translate(-5px, 3px); filter: hue-rotate(40deg) saturate(2); }
      20%  { opacity: 0.6; transform: translate(4px, -2px); filter: hue-rotate(-20deg); }
      30%  { opacity: 1; transform: translate(-3px, 1px); filter: contrast(2); }
      40%  { opacity: 0.4; transform: translate(2px, -3px); filter: hue-rotate(90deg); }
      60%  { opacity: 0.8; transform: translate(-2px, 2px); filter: none; }
      80%  { opacity: 0.2; transform: translate(0,0); }
      100% { opacity: 0; transform: translate(0,0); filter: none; }
    }
  </style>
</head>

<body>

<!-- TITLE SCREEN -->
<div id="title-screen" class="screen active">
  <img id="title-image" class="title-frame" src="assets/screens/title/title1.png">
  <div class="press-enter">PRESS ENTER</div>
</div>

<!-- MENU SCREEN -->
<div id="menu-screen" class="screen">
  <img src="assets/screens/start/startscreen1.png" class="title-frame">
  <div class="menu">
    <div class="menu-item" id="new-game">NEW GAME</div>
    <div class="menu-item">CONTINUE</div>
    <div class="menu-item">SETTINGS</div>
  </div>
</div>

<!-- NEW GAME SCREEN -->
<div id="newgame-screen" class="screen">
  <img src="assets/screens/new-game/newgame1.png" class="title-frame">
  <div class="press-enter">BEGIN</div>
</div>

<!-- GLITCH FLASH -->
<div id="glitch" class="glitch-flash"></div>

<!-- AUDIO -->
<audio id="intro-audio" src="docs/assets/audio/intro.ogg" preload="auto"></audio>

<script>
/* ----------------------------------
   TITLE SCREEN ANIMATION LOOP
---------------------------------- */

const frames = [
  "assets/screens/title/title1.png",
  "assets/screens/title/title2.png",
  "assets/screens/title/title3.png",
  "assets/screens/title/title4.png",
  "assets/screens/title/title5.png",
  "assets/screens/title/title4.png",
  "assets/screens/title/title3.png",
  "assets/screens/title/title2.png"
];

let frameIndex = 0;
const titleImage = document.getElementById("title-image");

function animateTitle() {
  frameIndex = (frameIndex + 1) % frames.length;
  titleImage.src = frames[frameIndex];
}

setInterval(animateTitle, 150);

/* ----------------------------------
   AUDIO PLAYBACK
---------------------------------- */

const introAudio = document.getElementById("intro-audio");
introAudio.volume = 0.7;
introAudio.loop = true;

function enableAudio() {
  introAudio.play().catch(() => {});
}

window.addEventListener("click", enableAudio, { once: true });
window.addEventListener("keydown", enableAudio, { once: true });

/* ----------------------------------
   GLITCH TRANSITIONS
---------------------------------- */

function glitchTransition(fromId, toId) {
  const glitch = document.getElementById("glitch");
  glitch.style.animation = "glitchFlash 0.35s linear";

  setTimeout(() => {
    glitch.style.animation = "none";
    document.getElementById(fromId).classList.remove("active");
    document.getElementById(toId).classList.add("active");
  }, 350);
}

/* TITLE → MENU */
window.addEventListener("keydown", (e) => {
  if (e.key === "Enter") {
    glitchTransition("title-screen", "menu-screen");
  }
});

window.addEventListener("click", () => {
  glitchTransition("title-screen", "menu-screen");
});

/* MENU → NEW GAME */
document.getElementById("new-game").addEventListener("click", () => {
  glitchTransition("menu-screen", "newgame-screen");
});
</script>

</body>
</html>
